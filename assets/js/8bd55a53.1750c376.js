"use strict";(self.webpackChunkgetdeck=self.webpackChunkgetdeck||[]).push([[310],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},b=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),b=s(n),d=i,k=b["".concat(c,".").concat(d)]||b[d]||u[d]||o;return n?r.createElement(k,a(a({ref:t},p),{},{components:n})):r.createElement(k,a({ref:t},p))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=b;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:i,a[1]=l;for(var s=2;s<o;s++)a[s]=n[s];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}b.displayName="MDXCreateElement"},5794:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var r=n(7462),i=(n(7294),n(3905));const o={title:"Beiboot Client",sidebar_position:4,description:"Options for Beiboot to be used from a client"},a=void 0,l={unversionedId:"client",id:"client",title:"Beiboot Client",description:"Options for Beiboot to be used from a client",source:"@site/beiboot/client.md",sourceDirName:".",slug:"/client",permalink:"/beiboot/client",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Beiboot Client",sidebar_position:4,description:"Options for Beiboot to be used from a client"},sidebar:"docsSidebar",previous:{title:"Installation",permalink:"/beiboot/installation"},next:{title:"Configuration",permalink:"/beiboot/configuration"}},c={},s=[{value:"Using <code>deck</code> CLI With Provider <code>beiboot</code>",id:"using-deck-cli-with-provider-beiboot",level:2},{value:"Working with <code>kubectl</code>",id:"working-with-kubectl",level:2},{value:"Creating a Logical Kubernetes Cluster",id:"creating-a-logical-kubernetes-cluster",level:3},{value:"Deleting a Logical Kubernetes Cluster",id:"deleting-a-logical-kubernetes-cluster",level:3},{value:"Beiboot Python Client",id:"beiboot-python-client",level:2},{value:"Task Overview",id:"task-overview",level:3},{value:"Client Architecture",id:"client-architecture",level:3}],p={toc:s};function u(e){let{components:t,...o}=e;return(0,i.kt)("wrapper",(0,r.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"There are currently three options available to work with Beiboot clusters:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Using the ",(0,i.kt)("inlineCode",{parentName:"li"},"deck")," CLI with a ",(0,i.kt)("inlineCode",{parentName:"li"},"beiboot")," provider "),(0,i.kt)("li",{parentName:"ol"},"Working with ",(0,i.kt)("inlineCode",{parentName:"li"},"kubectl")," directly"),(0,i.kt)("li",{parentName:"ol"},"Using the Python client")),(0,i.kt)("h2",{id:"using-deck-cli-with-provider-beiboot"},"Using ",(0,i.kt)("inlineCode",{parentName:"h2"},"deck")," CLI With Provider ",(0,i.kt)("inlineCode",{parentName:"h2"},"beiboot")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"deck")," CLI from version ",(0,i.kt)("strong",{parentName:"p"},"0.9.0+")," integrated Beiboot as ",(0,i.kt)("a",{parentName:"p",href:"/docs/deckfile-specs/#provider"},"supported cluster provider"),".\nA ",(0,i.kt)("a",{parentName:"p",href:"/docs/deckfile-specs/"},"Deckfile")," specifying the host cluster and port-mapping is required, too. Please read on\n",(0,i.kt)("a",{parentName:"p",href:"/beiboot/configuration/#usage"},"how to write a Deckfile using Beiboot"),"."),(0,i.kt)("h2",{id:"working-with-kubectl"},"Working with ",(0,i.kt)("inlineCode",{parentName:"h2"},"kubectl")),(0,i.kt)("h3",{id:"creating-a-logical-kubernetes-cluster"},"Creating a Logical Kubernetes Cluster"),(0,i.kt)("p",null,"Creating a logical Kubernetes cluster using Beiboot is very easy:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cat <<EOF | kubectl apply -f -\napiVersion: getdeck.dev/v1\nkind: beiboot\nmetadata:\n  name: cluster-1\n  namespace: getdeck\nprovider: k3s\nEOF\n")),(0,i.kt)("p",null,"It creates an object of type beiboot. Required fields are ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"provider")," (currently only ",(0,i.kt)("em",{parentName:"p"},"k3s")," is supported)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"> kubectl -n getdeck get bbt \nNAME        AGE\ncluster-1   1m22s\n")),(0,i.kt)("p",null,"The cluster is going to be created in namespace ",(0,i.kt)("inlineCode",{parentName:"p"},"getdeck-bbt-cluster-1")," of the host cluster.\nOnce the cluster is ready you can retrieve the ",(0,i.kt)("em",{parentName:"p"},"kubeconfig")," from the beiboot object running:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl -n getdeck get bbt cluster-1 --no-headers -o=custom-columns=:.kubeconfig.source | base64 -d > cluster-1.yaml\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Important:")," Please note that this ",(0,i.kt)("em",{parentName:"p"},"kubeconfig")," specifies the server to be reachable at ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("a",{parentName:"em",href:"https://127.0.0.1:6443"},"https://127.0.0.1:6443")),".\nTo reach this logical Kubernetes cluster you have to set up a ",(0,i.kt)("inlineCode",{parentName:"p"},"kubectl port-forward")," on your local machine."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl port-forward -n getdeck-bbt-cluster-1 svc/kubeapi 6443:6443\n")),(0,i.kt)("p",null,"Now, in a different terminal you can set ",(0,i.kt)("inlineCode",{parentName:"p"},"export KUBECONFIG=<path>/cluster-1.yaml")," and you are ready to go. In this terminal\nsession you can now use ",(0,i.kt)("em",{parentName:"p"},"kubectl")," just as usual."),(0,i.kt)("h3",{id:"deleting-a-logical-kubernetes-cluster"},"Deleting a Logical Kubernetes Cluster"),(0,i.kt)("p",null,"If you wish to remove the logical Kubernetes cluster, please type:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl -n getdeck delete bbt cluster-1\n")),(0,i.kt)("p",null,"and the entire namespace in the host cluster will be gone in a matter of seconds."),(0,i.kt)("h2",{id:"beiboot-python-client"},"Beiboot Python Client"),(0,i.kt)("h3",{id:"task-overview"},"Task Overview"),(0,i.kt)("p",null,"Beiboot comes with a dedicated Python package which handles the following client processes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"ordering a new Beiboot cluster (with arguments)"),(0,i.kt)("li",{parentName:"ul"},"deleting an existing Beiboot cluter"),(0,i.kt)("li",{parentName:"ul"},"downloading the ",(0,i.kt)("em",{parentName:"li"},"kubeconfig")," and saving it to ",(0,i.kt)("inlineCode",{parentName:"li"},"~/.getdeck/<cluster-name>.yaml")),(0,i.kt)("li",{parentName:"ul"},"setting up the local proxy to access the Beiboot cluster"),(0,i.kt)("li",{parentName:"ul"},"keeping the cluster alive by sending a heartbeat")),(0,i.kt)("p",null,"Please find the Python package on ",(0,i.kt)("em",{parentName:"p"},"pypi.org")," ",(0,i.kt)("a",{parentName:"p",href:"https://pypi.org/project/beiboot/"},"https://pypi.org/project/beiboot/"),".",(0,i.kt)("br",{parentName:"p"}),"\n","You can install it with:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"pip install beiboot\n")),(0,i.kt)("p",null,"The Python client is released with every release of Beiboot."),(0,i.kt)("h3",{id:"client-architecture"},"Client Architecture"),(0,i.kt)("p",null,"The Beiboot operator handles all cluster-side components to run a logical Kubernetes cluster. Yet, for users to connect\nto it a certain amount of client-side process logic is required."),(0,i.kt)("p",null,"The Beiboot client manages the following components on the users machine:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"creating a ",(0,i.kt)("inlineCode",{parentName:"li"},"beiboot")," object (a Kubernetes extension) to request a Beiboot cluster"),(0,i.kt)("li",{parentName:"ul"},"watching this object until the Beiboot operator updates it with the _",(0,i.kt)("em",{parentName:"li"},"kubeconfig")," (a YAML-file)"),(0,i.kt)("li",{parentName:"ul"},"storing the ",(0,i.kt)("em",{parentName:"li"},"kubeconfig")," on the local machine so the user can be use it (for instance by setting ",(0,i.kt)("inlineCode",{parentName:"li"},"export KUBECONFIG=..."),")"),(0,i.kt)("li",{parentName:"ul"},"establishing a ",(0,i.kt)("inlineCode",{parentName:"li"},"kubectl port-forward")," for every requested port-mapping in a Docker process")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Getdeck Beiboot client",src:n(528).Z,width:"1017",height:"871"})),(0,i.kt)("p",null,"The Beiboot client allows reconnecting to an existing cluster by fetching the ",(0,i.kt)("em",{parentName:"p"},"kubeconfig")," again and setting up the\nlocal proxy facilities.  "),(0,i.kt)("p",null,"Once the Beiboot cluster is not needed anymore, client removes the ",(0,i.kt)("inlineCode",{parentName:"p"},"beiboot")," object in Kubernetes. Running proxies are\nremoved, too."))}u.isMDXComponent=!0},528:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/beiboot-client-9dea20830691b3e268653d5d2cccd0c0.png"}}]);